{% extends "base.html" %}

{% block title %}Smart-RAG Chat - AI 어시스턴트{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="/static/css/chat.css">
{% endblock %}

{% block content %}
<div class="chat-layout">
    <!-- 사이드바 -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Chats</h2>
            <button class="new-chat-button">
                <i class="fas fa-plus"></i> New Chat
            </button>
        </div>
        <ul class="chat-list">
            <!-- Chat items will be dynamically loaded here -->
            <li class="chat-item active">
                <span class="chat-title">New Conversation</span>
                <button class="chat-options-button"><i class="fas fa-ellipsis-v"></i></button>
            </li>
        </ul>
    </aside>

    <!-- 메인 채팅 영역 -->
    <section class="chat-main">
        <div class="chat-header">
            <h3>Current Conversation</h3>
            <div class="chat-actions">
                <button class="icon-button"><i class="fas fa-share-alt"></i></button>
                <button class="icon-button"><i class="fas fa-trash-alt"></i></button>
            </div>
        </div>
        <div class="chat-messages" id="chat-messages">
            <!-- Chat messages will be dynamically loaded here -->
            <div class="message-bubble assistant">
                <div class="message-content">안녕하세요! 저는 Smart-RAG AI 어시스턴트입니다. 무엇을 도와드릴까요? 날씨, 주식, 계산, 웹 검색, 지식베이스 검색 등 다양한 작업을 도와드릴 수 있습니다.</div>
                <div class="message-info">
                    <span class="message-time">10:01 AM</span>
                </div>
            </div>
        </div>

        <div class="chat-input-container">
            <div class="chat-input-area">
                <button id="upload-pdf-button" class="upload-button" title="PDF 업로드">
                    <i class="fas fa-paperclip"></i>
                </button>
                <textarea
                    id="chat-input"
                    placeholder="메시지를 입력하세요..."
                    rows="1"
                ></textarea>
                <button id="send-button" class="send-button">
                    <i class="fas fa-paper-plane"></i>
                </button>
                <button id="stop-button" class="stop-button hidden">
                    <i class="fas fa-stop"></i>
                </button>
            </div>
            <!-- 숨겨진 파일 입력 -->
            <input type="file" id="pdf-file-input" accept=".pdf" style="display: none;">
        </div>
    </section>
</div>

<!-- 연결 상태 표시 -->
<div id="connection-status" class="connection-status disconnected">연결 끊김</div>

<!-- 로딩 오버레이 -->
<div id="loading-overlay" class="loading-overlay hidden">
    <div class="loading-spinner">
        <div class="spinner"></div>
        <p>처리 중...</p>
    </div>
</div>

<!-- 설정 모달 -->
<div id="settings-modal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3>설정</h3>
            <button id="close-settings" class="btn btn-icon">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="setting-group">
                <label for="theme-select">테마</label>
                <select id="theme-select" class="form-select">
                    <option value="light">라이트 모드</option>
                    <option value="dark">다크 모드</option>
                </select>
            </div>
            <div class="setting-group">
                <label for="chat-mode">채팅 모드</label>
                <select id="chat-mode" class="form-select">
                    <option value="parallel">병렬 처리</option>
                    <option value="adaptive">적응형 처리</option>
                </select>
            </div>
        </div>
        <div class="modal-footer">
            <button id="cancel-settings" class="btn btn-secondary">취소</button>
            <button id="save-settings" class="btn btn-primary">저장</button>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts_extra %}
<script src="/static/js/chat.js"></script>
{% endblock %}
